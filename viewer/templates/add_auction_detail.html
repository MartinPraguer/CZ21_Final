{% extends "base.html" %}
{% block content %}

<!-- Zobrazení obrázků pro danou aukci -->
{% if auction.images.all %}
    <h3>Images:</h3>
    <div>
        {% for image in auction.images.all %}
            <img src="{{ image.image.url }}" alt="Image for {{ auction.name_auction }}" style="width: 300px; height: auto;">
        {% endfor %}
    </div>
{% else %}
    <p>No images for this auction.</p>
{% endif %}
<h2>{{ auction.name_auction }}</h2>
<p>Category: {{ auction.category }}</p>
<p>Description: {{ auction.description }}</p>
<p>Auction Creater: {{ auction.user_creator }}</p>

<p>Auction Starts: {{ auction.auction_start_date|date:"d.m.Y H:i:s" }}</p>
<p>Auction Ends: {{ auction.auction_end_date|date:"d.m.Y H:i:s" }}</p>
{% if auction_expired %}
    <p>Auction has expired</p>
{% else %}
    <p>Time Left: {{ days }} days, {{ hours }} hours, {{ minutes }} minutes</p>
{% endif %}

{% if auction.auction_type == 'buy_now' %}
    <p>Price: {{ auction.buy_now_price }} Kč</p>
    <h3>Buy Now</h3>

    {% if auction_expired %}
        <p style="color: red;">This auction has already expired. It cannot be bought.</p>
    {% else %}

        <form method="post" action="{% url 'add_to_cart' auction.pk %}">
            {% csrf_token %}
            <button type="submit">Add to Cart</button>
        </form>
    {% endif %}
{% endif %}

{% if auction.auction_type == 'place_bid' %}
    <p>Starting Price: {{ auction.start_price }} Kč</p>
    {% if auction.price %}
        <p>Price: {{ auction.price }} Kč</p>
    {% endif %}
    <p>Minimum Bid: {{ auction.minimum_bid }} Kč</p>

    {% if auction_expired %}
        <p style="color: red;">The auction has already ended. It is not possible to add more bids.</p>
    {% else %}
        <form method="post">
            {% csrf_token %}
            <label for="new_bid">Your Bid:</label>
            <input type="number" name="new_bid" min="1" required>
            <button type="submit">Place Bid</button>
        </form>
    {% endif %}
    
    <h2>Bids</h2>
    {% if bids %}
        <table>
            <thead>
                <tr>
                    <th>Price</th>
                    <th>Bid</th>
                    <th>Time</th>
                    <th>User</th>
                </tr>
            </thead>
            <tbody>
                {% for bid in bids %}
                <tr>
                    <td>{{ bid.price }}</td>
                    <td>{{ bid.amount }} Kč</td>
                    <td>{{ bid.timestamp|date:"d.m.Y H:i:s" }}</td>
                    <td>{{ bid.user }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No bids yet.</p>
    {% endif %}
{% endif %}

<a href="javascript:history.back()" style="text-decoration: none; color: inherit;">Back to Previous Page</a>

{% endblock %}
